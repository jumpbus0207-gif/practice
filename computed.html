<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Vue.js sample-computed</title>
    <link rel="stylesheet" href="./css/style.css">
    <script src="./js/vue.js"></script>
</head>
<body>
    <h2>データを使って別の計算をする</h2>
    <div id="priceTax">
        <input v-model.number="price" type="number">円
        <p>消費税込みの金額{{taxIncluded}}円</p>
    </div>
    <hr>

    <div id="priceTax02">
        <input v-model.number="price" type="number">円 ×
        <input v-model.number="count" type="number">個
        <p>合計{{sum}}円</p>
        <p>税込み合計{{taxIncluded}}円</p>
    </div>
    <hr>

    <div id="computedColor">
        <p>ご感想は、140文字以内でご入力ください。</p>
        <textarea v-model="myText"></textarea>
        <p :style="{color: computedColor}">残り{{remaining}}文字
            です。
        </p>
    </div>
    <hr>

    <div id="find">
        <input v-model="findWord">
        <ul>
            <li v-for="item in findItems">{{item}}</li>
        </ul>
    </div>
    <hr>

    <div id="colorBar">
        <p :style="{backgroundColor: mixColor}">{{mixColor}}</p>
        <input type="range" v-model="R" min="0" max="255"><br>
        <input type="range" v-model="G" min="0" max="255"><br>
        <input type="range" v-model="B" min="0" max="255"><br>
    </div>
    <hr>

<script>
new Vue({
    el: '#priceTax',
    data: {
        price:100
    },
    computed: {
        // priceが変わったら、消費税込み金額を算出する
        taxIncluded: function() {
            return this.price * 1.08;
        }
    }
})

new Vue({
    el: '#priceTax02',
    data: {
        price:100,
        count:1
    },
    computed: {
        // priceかcountが変わったら、合計金額を算出する
        sum: function() {
            return this.price * this.count;
        },
        // 合計金額が変わったら、消費税込み金額を算出する
        taxIncluded: function() {
            return this.sum * 1.08;
        }
    }
})

new Vue({
    el: '#computedColor',
    data: {
        myText:'今日は、いい天気です。'
    },
    computed: {
        // myTextの長さが変わったら、残りの文字数を算出する
        remaining: function() {
            return 140 - this.myText.length;
        },
        // remainingが変わったら、computedColorを算出する。
        computedColor: function() {
            col = "green";
            if(this.remaining < 20) {
                col = "orange";
            }
            if(this.remaining < 1 ) {
                col = "red";
            }
            return col;
        }
    }
})

new Vue({
    el: '#find',
    data: {
        findWord:'',
        items:['桃太郎', '花咲か爺さん', '浦島太郎', 'かぐや姫', 'かちかち山']
    },
    computed: {
        // this.findWordが変わったら、その文字が含まれるリストを算出する。
        findItems: function() {
            if(this.findWord) {
                return this.items.filter(function(value) {
                    return (value.indexOf(this.findWord) > -1);
                }, this);
            } else {
                // this.findWordが空の時は、リストをそのまま返す
                return this.items;
            }
        }
    }
})

new Vue({
    el: '#colorBar',
    data: {
        R:255,
        G:150,
        B:100
    },
    computed: {
        // RかGかBの値が変わったら、できた色を算出する。
        mixColor: function() {
            var ans = "RGB("+this.R+","+this.G+","+this.B+")";
            return ans;
        }
    }
})
</script>
</body>
</html>